function random_nr(e){return Math.floor(Math.random()*e)}function validatePoem(){var e=$("#line1"),t=$("#line2"),o=e.val().trim(),l=t.val().trim();return""===l?(t.focus(),!1):""===o?(e.focus(),!1):!0}function poemLineMouseOn(){var e=$(this).data("color"),t=$(this).data("location");$(".poem-line").not(this).css("opacity","0.37"),$("#location_display").html(t).addClass("full-opacity"),$("html").addClass("location-display")}function poemLineMouseOff(){$(".poem-line").not(this).css("opacity","1"),$("#location_display").removeClass("full-opacity"),$("html").removeClass("location-display")}function reload(){location.reload()}function padding_color(){var e=$(this).css("background-color");$(this).css("box-shadow","5px 0 0 "+e+", -5px 0 0 "+e)}function type_last_line2(){$(".last-line-2").length>0?$(".last-line-2").typeIt({autoStart:!0,startDelay:150,cursor:!1,speed:80,callback:function(){$(".poemInput, .last-line-2").removeClass("transparent-border")}}):$(".poemInput, .last-line-2").removeClass("transparent-border")}function help1Line1(){$(".last-line-2").addClass("help-active");var e="<button id='okstop' onclick='help_cancel()'>Got it</button>";$("#submit-btn").replaceWith(e),help=!0,run_help=!0,console.log("help = true");var t=$("#help-1"),o=t.data("title");o=$("#"+o),o.focus(),t.typeIt({autoStart:!0,cursor:!1,speed:80,deleteSpeed:50,callback:function(){help===!0&&help2Line2()}}).tiType("okay, so").tiPause(900).tiDelete().tiPause(300).tiType("folding poetry is a place for writing poetry").tiPause(200)}function help2Line2(){var e=$("#help-2"),t=e.data("title");t=$("#"+t),t.focus(),e.typeIt({autoStart:!0,cursor:!1,speed:80,deleteSpeed:50,callback:function(){help===!0&&($(".last-line-2").length?help3Line1():new_poem_help3Line1())}}).tiPause(90).tiType("together").tiPause(900).tiDelete()}function help3Line1(){var e=$("#help-1"),t=e.data("title");t=$("#"+t),t.select(),setTimeout(function(){e.typeIt({autoStart:!0,cursor:!1,speed:80,deleteSpeed:50,callback:function(){help===!0&&help3Line2()}}).tiPause(400).tiType("someone was just here").tiPause(900).tiDelete().tiType("&#8592; they wrote this").tiPause(1100).tiDelete().tiType("now you can build on it").tiPause(900).tiDelete().tiType("continue the poem up here").tiPause(600)},500)}function new_poem_help3Line1(){var e=$("#help-1"),t=e.data("title"),t=$("#"+t);t.select(),setTimeout(function(){e.typeIt({autoStart:!0,cursor:!1,speed:76,deleteSpeed:50,callback:function(){help===!0&&help3Line2()}}).tiPause(300).tiType("you're actually kind of special &lt;3").tiPause(800).tiDelete().tiType("cause you get to start a new poem").tiPause(800).tiDelete().tiType("first, write something up here").tiPause(150)},500)}function help3Line2(){var e=$("#help-2"),t=e.data("title");t=$("#"+t),t.focus(),e.typeIt({autoStart:!0,cursor:!1,speed:75,deleteSpeed:50,callback:function(){help===!0&&help5Line1()}}).tiPause(200).tiType("then down here").tiPause(800).tiDelete()}function help5Line1(){var e=$("#help-1"),t=e.data("title"),t=$("#"+t);t.select(),setTimeout(function(){e.typeIt({autoStart:!0,cursor:!1,speed:72,deleteSpeed:50,callback:function(){help===!0&&help5Line2()}}).tiType("the next person will only see").tiPause(200)},600)}function help5Line2(){var e=$("#help-2"),t=e.data("title");t=$("#"+t),t.focus(),e.typeIt({autoStart:!0,cursor:!1,speed:81,deleteSpeed:50,callback:function(){$("#line1").select(),setTimeout(function(){help_cancel()},500)}}).tiPause(250).tiType("this second part").tiPause(1300).tiDelete().tiPause(200)}function auto_help(e){if(returning===!1&&e===!1){var t=line1.val().trim(),o=line2.val().trim();0===t.length&&0===o.length?(help1Line1(),console.log("help!")):console.log("something there...")}else console.log("been here before!")}function help_click(){console.log("clicked ?"),help===!1?help1Line1():help_cancel()}function help_cancel(){run_help=!1,$(".help-me").removeClass("help_animate"),$(".poemInput").val(""),$("#help-notice").hide(),$("#line1").focus(),$(".last-line-2").removeClass("help-active"),$("#okstop").replaceWith("<input id='submit-btn' type='submit' value='Submit' name='submit'>"),help=!1,console.log("help = false")}function stay(){$.post("../includes/continue_writing.php",{wp_id:wp_id_global},function(e,t){console.log("return from file: "+e+" Status of the query: "+t)}),clearTimeout(timeout),clearTimeout(reloadTimer),clearTimeout(countdownTimer),count=15,$("main").removeClass("blur"),line1.focus(),timeout=setTimeout(function(){timeoutMessage()},timerDelay),$("#message-overlay").hide()}function timeoutMessage(){countdown(),$("#message-overlay").css("display","flex"),$("main").addClass("blur"),reloadTimer=setTimeout(letGo,15e3)}function countdown(){var e=$("#countdown");e.html(count),count--,count>-1&&(countdownTimer=setTimeout(function(){countdown()},1e3))}function letGo(){$("#alert-title").html("Sorry, we had to let you go"),$("#alert-first").html("There are people in line kid"),$("#alert-second").hide(),$("#submit-btn").attr("disabled","disabled"),$("#stay").html("Reload page").attr("onclick","reload()")}function unload_the_poem(){$.ajax({method:"POST",url:"unload.php",data:{wp_id:wp_id_global},success:function(e,t){console.log("return from unload: "+e+" Status of the query: "+t)},timout:1500,async:!1})}function clear_cookies(){console.log("clear cookies"),$.post("clear_cookies.php")}function hasScrolled(){var e=$(this).scrollTop();Math.abs(lastScrollTop-e)<=delta||(e>lastScrollTop&&e>200?($("header").addClass("nav-up"),lastScrollTop=e):lastScrollTop-150>e&&(e+$(window).height()<$(document).height()&&$("header").removeClass("nav-up"),lastScrollTop=e))}function copy_content(e){var t=$("<input>");$("body").append(t),t.val($(e).text()).select(),document.execCommand("copy"),t.remove()}function getCaretPosition(e){var t=e.get(0);if(t){if("selectionStart"in t)return t.selectionStart;if(document.selection){t.focus();var o=document.selection.createRange(),l=document.selection.createRange().text.length;return o.moveStart("character",-t.value.length),o.text.length-l}}}function welcome_highlight(e){e.addClass("highlight")}$(document).ready(function(){window.sr=ScrollReveal({duration:650,delay:160,scale:.95}),wp_id_global=$("#wp_id").html(),console.log("The wp id is: "+wp_id_global),run_help=!0,help=!1,line1=$("#line1"),line2=$("#line2");var e=new Audio("audio/click.mp3");e.volume=.15,returning=void 0===Cookies.get("returning")?!1:!0,count=15;var t=6;timerDelay=6e4*t-1e3*count,timeout=setTimeout(function(){timeoutMessage()},timerDelay);var o=!1,l=$("header").waypoint({handler:function(e){"up"==e&&($("#line1").focus(),auto_help(o),o=!0)},offset:-25});jQuery("img.svg").each(function(){var e=jQuery(this),t=e.attr("id"),o=e.attr("class"),l=e.attr("src");jQuery.get(l,function(l){var n=jQuery(l).find("svg");"undefined"!=typeof t&&(n=n.attr("id",t)),"undefined"!=typeof o&&(n=n.attr("class",o+" replaced-svg")),n=n.removeAttr("xmlns:a"),e.replaceWith(n)},"xml")}),$(".welcome-link").hover(function(){var e=$(this).data("highlight");e=$("#"+e),e.addClass("highlight")},function(){$(".highlight-field").removeClass("highlight")}),$(".poem-line").hover(poemLineMouseOn,poemLineMouseOff),$(".poemInput").keyup(function(){var t=$(this).val().length,o=$(this).attr("maxlength"),l=$(".poemInput").index(this);if(caretPosition=getCaretPosition($(this)),console.log("caret: "+caretPosition),$(this).is("#line1")&&t==o&&0===$("#line2").val().length){e.play();var n=$(this).val(),i=n.lastIndexOf(" "),a=n.substring(0,i);$("#line1").val(a);var s=n.split(" ").pop();$("#line2").val(s).focus()}}),$(".poemInput").keydown(function(e){8!==e.which&&13!==e.which&&27!==e.which||help!==!0?8!==e.which&&37!==e.which||0!==caretPosition||!$(this).is("#line2")?39===e.which&&caretPosition===$(this).val().length&&$(this).is("#line1")&&$("#line2").focus().get(0).setSelectionRange(0,0):$("#line1").focus():help_cancel()}),$(".help-me").click(function(){help_click()}),$(".poemInput").click(function(){help===!0&&help_cancel()}),$(".help-line").on("DOMSubtreeModified",function(){var e=$(this).text(),t=$(this).data("title");t=$("#"+t),run_help===!0&&(t.val(e),$(".ti-placeholder").empty())}),jQuery.ajax({url:"//freegeoip.net/json/",type:"POST",dataType:"jsonp",timeout:1e4,success:function(e){console.log("success");var t=e.city,o=e.country_name;t&&o?($("#location").attr("value",t+", "+o),console.log("You're in "+t+", "+o)):o&&($("#location").attr("value",o),console.log("You're in "+o))},error:function(){var e=made_up_places[Math.floor(Math.random()*made_up_places.length)];$("#location").attr("value",e),console.log("You're in "+e)}});var n=$("#hidden-last-line").text().length;console.log("last line length: "+n),11>n&&(console.log("less than 11"),$(".poemInput, .last-line-2").css("font-size","4.3vw")),$(window).on("beforeunload",function(){unload_the_poem()}),$("#pass-on").click(function(){copy_content("#pass_on_link"),$(this).after("<br><span class='small'>Copied!</span>")})}),$(function(){$('a[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=$(this.hash);if(e=e.length?e:$("[name="+this.hash.slice(1)+"]"),e.length)return $("html, body").animate({scrollTop:e.offset().top},1500,"easeInOutCubic"),!1}})});var didScroll,lastScrollTop=0,delta=5,navbarHeight=$("header").outerHeight();$(window).scroll(function(e){didScroll=!0}),setInterval(function(){didScroll&&(hasScrolled(),didScroll=!1)},250),made_up_places=["Atlantis","Hogwarts, England","Neverland","Hoth","Desert planet of Tatooine","Emerald City","Hill Valley, California","Sunnydale, California","Twin Peaks","Zion","Pandora","District 12","Gotham","Springfield","Stars Hollow, Connecticut"];